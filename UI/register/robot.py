# -*- coding: utf-8 -*-

# Form implementation generated from reading ui file 'Robot.ui'
#
# Created by: PyQt5 UI code generator 5.15.4
#
# WARNING: Any manual changes made to this file will be lost when pyuic5 is
# run again.  Do not edit this file unless you know what you are doing.


from PyQt5 import QtCore, QtGui, QtWidgets
from open_chrome import Chrome
# import background


class Robot_Ui(QtWidgets.QMainWindow):
    def __init__(self, patient, chat_bot):
        super(Robot_Ui, self).__init__()
        self.get_information = False
        self.patient = patient
        self.chat_bot = chat_bot
        self.setupUi(self)

    def setupUi(self, MainWindow):
        self.mainwindow = MainWindow
        MainWindow.setObjectName("MainWindow")
        MainWindow.resize(938, 657)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Expanding, QtWidgets.QSizePolicy.Expanding)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(MainWindow.sizePolicy().hasHeightForWidth())
        MainWindow.setSizePolicy(sizePolicy)
        icon = QtGui.QIcon()
        icon.addPixmap(QtGui.QPixmap(r"G:\code\pycharm\cancer_detection\UI\配图\7.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        MainWindow.setWindowIcon(icon)
        MainWindow.setStyleSheet("background-image: url(:/background/bg5.jpg);")
        self.centralwidget = QtWidgets.QWidget(MainWindow)
        self.centralwidget.setObjectName("centralwidget")
        self.verticalLayout = QtWidgets.QVBoxLayout(self.centralwidget)
        self.verticalLayout.setObjectName("verticalLayout")
        self.label_2 = QtWidgets.QLabel(self.centralwidget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Maximum, QtWidgets.QSizePolicy.Maximum)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.label_2.sizePolicy().hasHeightForWidth())
        self.label_2.setSizePolicy(sizePolicy)
        palette = QtGui.QPalette()
        brush = QtGui.QBrush(QtGui.QColor(255, 255, 255))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Active, QtGui.QPalette.WindowText, brush)
        brush = QtGui.QBrush(QtGui.QColor(255, 255, 255))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Inactive, QtGui.QPalette.WindowText, brush)
        brush = QtGui.QBrush(QtGui.QColor(120, 120, 120))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Disabled, QtGui.QPalette.WindowText, brush)
        self.label_2.setPalette(palette)
        font = QtGui.QFont()
        font.setFamily("Arial Black")
        font.setPointSize(6)
        font.setBold(True)
        font.setWeight(75)
        self.label_2.setFont(font)
        self.label_2.setObjectName("label_2")
        self.verticalLayout.addWidget(self.label_2)
        self.horizontalLayout_2 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_2.setObjectName("horizontalLayout_2")
        self.label = QtWidgets.QLabel(self.centralwidget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Maximum, QtWidgets.QSizePolicy.Maximum)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.label.sizePolicy().hasHeightForWidth())
        self.label.setSizePolicy(sizePolicy)
        self.label.setText("")
        self.label.setPixmap(QtGui.QPixmap(r"G:\code\pycharm\cancer_detection\UI\配图\24.png"))
        self.label.setObjectName("label")
        self.horizontalLayout_2.addWidget(self.label)
        self.label_3 = QtWidgets.QLabel(self.centralwidget)
        palette = QtGui.QPalette()
        brush = QtGui.QBrush(QtGui.QColor(255, 255, 255))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Active, QtGui.QPalette.WindowText, brush)
        brush = QtGui.QBrush(QtGui.QColor(255, 255, 255))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Inactive, QtGui.QPalette.WindowText, brush)
        brush = QtGui.QBrush(QtGui.QColor(120, 120, 120))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Disabled, QtGui.QPalette.WindowText, brush)
        self.label_3.setPalette(palette)
        font = QtGui.QFont()
        font.setFamily("Perpetua Titling MT")
        font.setPointSize(8)
        font.setBold(True)
        font.setWeight(75)
        self.label_3.setFont(font)
        self.label_3.setObjectName("label_3")
        self.horizontalLayout_2.addWidget(self.label_3)
        self.verticalLayout.addLayout(self.horizontalLayout_2)
        self.label_5 = QtWidgets.QLabel(self.centralwidget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Maximum, QtWidgets.QSizePolicy.Preferred)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.label_5.sizePolicy().hasHeightForWidth())
        self.label_5.setSizePolicy(sizePolicy)
        palette = QtGui.QPalette()
        brush = QtGui.QBrush(QtGui.QColor(255, 255, 255))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Active, QtGui.QPalette.WindowText, brush)
        brush = QtGui.QBrush(QtGui.QColor(255, 255, 255))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Inactive, QtGui.QPalette.WindowText, brush)
        brush = QtGui.QBrush(QtGui.QColor(120, 120, 120))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Disabled, QtGui.QPalette.WindowText, brush)
        self.label_5.setPalette(palette)
        font = QtGui.QFont()
        font.setFamily("Arial Black")
        font.setBold(True)
        font.setWeight(75)
        self.label_5.setFont(font)
        self.label_5.setObjectName("label_5")
        self.verticalLayout.addWidget(self.label_5)
        self.horizontalLayout_8 = QtWidgets.QHBoxLayout()
        self.horizontalLayout_8.setObjectName("horizontalLayout_8")
        self.label_6 = QtWidgets.QLabel(self.centralwidget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Expanding, QtWidgets.QSizePolicy.Preferred)
        sizePolicy.setHorizontalStretch(1)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.label_6.sizePolicy().hasHeightForWidth())
        self.label_6.setSizePolicy(sizePolicy)
        self.label_6.setText("")
        self.label_6.setPixmap(QtGui.QPixmap(r"G:\code\pycharm\cancer_detection\UI\配图\rob.png"))
        self.label_6.setObjectName("label_6")
        self.horizontalLayout_8.addWidget(self.label_6)
        self.textEdit = QtWidgets.QTextEdit(self.centralwidget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Expanding, QtWidgets.QSizePolicy.Expanding)
        sizePolicy.setHorizontalStretch(6)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.textEdit.sizePolicy().hasHeightForWidth())
        self.textEdit.setSizePolicy(sizePolicy)
        self.textEdit.setObjectName("textEdit")
        self.textEdit.setFontPointSize(17)
        color = QtGui.QColor()
        color.setNamedColor('white')
        self.textEdit.setTextColor(color)
        self.horizontalLayout_8.addWidget(self.textEdit)
        self.horizontalLayout_8.setStretch(0, 1)
        self.verticalLayout.addLayout(self.horizontalLayout_8)
        self.horizontalLayout = QtWidgets.QHBoxLayout()
        self.horizontalLayout.setObjectName("horizontalLayout")
        self.upload_button = QtWidgets.QPushButton(self.centralwidget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Maximum, QtWidgets.QSizePolicy.Maximum)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.upload_button.sizePolicy().hasHeightForWidth())
        self.upload_button.setSizePolicy(sizePolicy)
        palette = QtGui.QPalette()
        brush = QtGui.QBrush(QtGui.QColor(255, 255, 255))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Active, QtGui.QPalette.ButtonText, brush)
        brush = QtGui.QBrush(QtGui.QColor(255, 255, 255))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Inactive, QtGui.QPalette.ButtonText, brush)
        brush = QtGui.QBrush(QtGui.QColor(120, 120, 120))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Disabled, QtGui.QPalette.ButtonText, brush)
        self.upload_button.setPalette(palette)
        font = QtGui.QFont()
        font.setFamily("Bahnschrift SemiBold")
        font.setBold(True)
        font.setWeight(75)
        self.upload_button.setFont(font)
        self.upload_button.setObjectName("upload_button")
        self.horizontalLayout.addWidget(self.upload_button)
        self.chatbot_button = QtWidgets.QPushButton(self.centralwidget)
        sizePolicy = QtWidgets.QSizePolicy(QtWidgets.QSizePolicy.Maximum, QtWidgets.QSizePolicy.Maximum)
        sizePolicy.setHorizontalStretch(0)
        sizePolicy.setVerticalStretch(0)
        sizePolicy.setHeightForWidth(self.chatbot_button.sizePolicy().hasHeightForWidth())
        self.chatbot_button.setSizePolicy(sizePolicy)
        palette = QtGui.QPalette()
        brush = QtGui.QBrush(QtGui.QColor(255, 255, 255))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Active, QtGui.QPalette.ButtonText, brush)
        brush = QtGui.QBrush(QtGui.QColor(255, 255, 255))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Inactive, QtGui.QPalette.ButtonText, brush)
        brush = QtGui.QBrush(QtGui.QColor(120, 120, 120))
        brush.setStyle(QtCore.Qt.SolidPattern)
        palette.setBrush(QtGui.QPalette.Disabled, QtGui.QPalette.ButtonText, brush)
        self.chatbot_button.setPalette(palette)
        font = QtGui.QFont()
        font.setFamily("Bahnschrift SemiBold")
        font.setBold(True)
        font.setWeight(75)
        self.chatbot_button.setFont(font)
        self.chatbot_button.setObjectName("chatbot_button")
        self.horizontalLayout.addWidget(self.chatbot_button)
        self.verticalLayout.addLayout(self.horizontalLayout)
        self.verticalLayout.setStretch(0, 1)
        self.verticalLayout.setStretch(1, 1)
        self.verticalLayout.setStretch(2, 1)
        self.verticalLayout.setStretch(3, 10)
        self.verticalLayout.setStretch(4, 1)
        MainWindow.setCentralWidget(self.centralwidget)
        self.menubar = QtWidgets.QMenuBar(MainWindow)
        self.menubar.setGeometry(QtCore.QRect(0, 0, 938, 26))
        self.menubar.setObjectName("menubar")
        self.menuMore_Inform = QtWidgets.QMenu(self.menubar)
        self.menuMore_Inform.setObjectName("menuMore_Inform")
        MainWindow.setMenuBar(self.menubar)
        self.actionUpload_Image = QtWidgets.QAction(MainWindow)
        icon1 = QtGui.QIcon()
        icon1.addPixmap(QtGui.QPixmap(r"G:\code\pycharm\cancer_detection\UI\配图\17.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.actionUpload_Image.setIcon(icon1)
        self.actionUpload_Image.setObjectName("actionUpload_Image")
        self.information_link = QtWidgets.QAction(MainWindow)
        icon2 = QtGui.QIcon()
        icon2.addPixmap(QtGui.QPixmap(r"G:\code\pycharm\cancer_detection\UI\配图\22.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.information_link.setIcon(icon2)
        self.information_link.setObjectName("information_link")
        self.actionBack_to_Register = QtWidgets.QAction(MainWindow)
        icon3 = QtGui.QIcon()
        icon3.addPixmap(QtGui.QPixmap(r"G:\code\pycharm\cancer_detection\UI\配图\20.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.actionBack_to_Register.setIcon(icon3)
        self.actionBack_to_Register.setObjectName("actionBack_to_Register")
        self.actionHistory = QtWidgets.QAction(MainWindow)
        icon4 = QtGui.QIcon()
        icon4.addPixmap(QtGui.QPixmap(r"G:\code\pycharm\cancer_detection\UI\配图\14.png"), QtGui.QIcon.Normal, QtGui.QIcon.Off)
        self.actionHistory.setIcon(icon4)
        self.actionHistory.setObjectName("actionHistory")
        self.actionSelect_One_Image = QtWidgets.QAction(MainWindow)
        font = QtGui.QFont()
        font.setFamily("Arial Narrow")
        self.actionSelect_One_Image.setFont(font)
        self.actionSelect_One_Image.setObjectName("actionSelect_One_Image")
        self.actionResults = QtWidgets.QAction(MainWindow)
        font = QtGui.QFont()
        font.setFamily("Arial Narrow")
        self.actionResults.setFont(font)
        self.actionResults.setObjectName("actionResults")
        self.actionDiagnose_Another = QtWidgets.QAction(MainWindow)
        font = QtGui.QFont()
        font.setFamily("Arial Narrow")
        self.actionDiagnose_Another.setFont(font)
        self.actionDiagnose_Another.setObjectName("actionDiagnose_Another")
        self.menuMore_Inform.addAction(self.information_link)
        self.menuMore_Inform.addAction(self.actionBack_to_Register)
        self.menubar.addAction(self.menuMore_Inform.menuAction())

        self.retranslateUi(MainWindow)

        self.chatbot_button.clicked.connect(self.get_response)
        self.actionBack_to_Register.triggered.connect(self.back_to_register)
        self.information_link.triggered.connect(self.open_chrome)
        QtCore.QMetaObject.connectSlotsByName(MainWindow)

    def back_to_register(self):
        self.textEdit.clear()
        self.get_information = False
        self.textEdit.setPlainText('->Bot:Hello! I am your personal diagnose assistant. We guarantee to protect the privacy of your personal information. If you agree to our confidentiality agreement, please fill in your serial number\n\n->You:')
        self.mainwindow.close()

    def get_response(self):
        all_text = self.textEdit.toPlainText()
        text = all_text.split('->You:')[-1]
        if self.get_information is False:
            serial_num = text
            self.get_information = self.patient.get_patient_information(serial_num=serial_num)

            if self.get_information is False:
                self.textEdit.append(
                    '\n->Bot:Wrong number. Have you registered? Please input your serial number again\n\n->You:')
            else:
                self.textEdit.append(
                    '\n->Bot:Welcome to the cancer diagnose system. You can chat with me or upload your own image. '
                    'if you want to know the diagnose of your image, you can ask "After analyzing the image, do I have a medical condition?"\n\n->You:')

        else:
            if text == 'After analyzing the image, do I have a medical condition?':
                if self.patient.diagnose_result is not None and self.patient.diagnose_result != 'None':
                    response = self.patient.diagnose_result
                else:
                    response = "You haven't uploaded your image yet, please press upload button and upload your image."
            else:
                response = self.chat_bot.get_response(text)
            self.textEdit.append('\n->Bot:{}\n\n->You:'.format(response))

    def open_chrome(self):
        chrome = Chrome()
        chrome.open_page()

    def retranslateUi(self, MainWindow):
        _translate = QtCore.QCoreApplication.translate
        MainWindow.setWindowTitle(_translate("MainWindow", "NLP Robot"))
        self.label_2.setText(_translate("MainWindow", "© PAST7009 TEAM 2"))
        self.label_3.setText(_translate("MainWindow", "Your Diagnose Assistant "))
        self.label_5.setText(_translate("MainWindow", "Talk to NLP Robot for more information"))
        self.textEdit.setHtml(_translate("MainWindow", "<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0//EN\" \"http://www.w3.org/TR/REC-html40/strict.dtd\">\n"
"<html><head><meta name=\"qrichtext\" content=\"1\" /><style type=\"text/css\">\n"
"p, li { white-space: pre-wrap; }\n"
"</style></head><body style=\" font-family:\'SimSun\'; font-size:9pt; font-weight:400; font-style:normal;\">\n"
"<p style=\"-qt-paragraph-type:empty; margin-top:0px; margin-bottom:0px; margin-left:0px; margin-right:0px; -qt-block-indent:0; text-indent:0px;\"><br /></p></body></html>"))
        self.textEdit.setPlainText('->Bot:Hello! I am your personal diagnose assistant. We guarantee to protect the privacy of your personal information. If you agree to our confidentiality agreement, please fill in your serial number\n\n->You:')
        self.upload_button.setText(_translate("MainWindow", "Upload Your CT Image"))
        self.chatbot_button.setText(_translate("MainWindow", "Talk to●ˍ● NLP Robot"))
        self.menuMore_Inform.setTitle(_translate("MainWindow", "About"))
        self.actionUpload_Image.setText(_translate("MainWindow", "Upload Image"))
        self.information_link.setText(_translate("MainWindow", "More Inform."))
        self.actionBack_to_Register.setText(_translate("MainWindow", "Back to Register"))
        self.actionHistory.setText(_translate("MainWindow", "History"))
        self.actionSelect_One_Image.setText(_translate("MainWindow", "Select One Image "))
        self.actionResults.setText(_translate("MainWindow", "Results"))
        self.actionDiagnose_Another.setText(_translate("MainWindow", "Diagnose Another"))

